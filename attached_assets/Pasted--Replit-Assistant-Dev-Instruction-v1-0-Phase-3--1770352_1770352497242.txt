ì¢‹ì•„ìš”. ì•„ë˜ëŠ” **Replit Assistantì— ê·¸ëŒ€ë¡œ ë¶™ì—¬ë„£ì–´ì„œ ì‹¤í–‰ ì§€ì‹œë¡œ ì“°ëŠ” ë²„ì „ (Dev Instruction v1.0 / Phase 3)** ì…ë‹ˆë‹¤.
êµ°ë”ë”ê¸° ì„¤ëª… ì—†ì´ **í•´ì•¼ í•  ì¼ë§Œ** ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.

---

# ğŸš€ Dev Instruction v1.0 â€” Phase 3 (BYO LLM)

## ëª©í‘œ

* ì‚¬ìš©ìê°€ **ìê¸° LLM Provider(API í‚¤)** ë¥¼ ì§ì ‘ ì—°ê²°
* **ë´‡ë§ˆë‹¤** ì‚¬ìš©í•  LLM ì„ íƒ ê°€ëŠ¥
* ë¦¬í¬íŠ¸/ë¶„ì„/ì´ˆì•ˆ ìƒì„± ì‹œ **í•´ë‹¹ ë´‡ì— ì—°ê²°ëœ LLM** ì‚¬ìš©
* ì‹œìŠ¤í…œ ê¸°ë³¸ LLM ì˜ì¡´ ì œê±°
* ë§íˆ¬/ìŠ¤íƒ€ì¼/ìºë¦­í„°ëŠ” **ì´ë²ˆ ë‹¨ê³„ì—ì„œ ë‹¤ë£¨ì§€ ì•ŠìŒ**

---

## Step 3-1. DB ìŠ¤í‚¤ë§ˆ ì¶”ê°€

### í…Œì´ë¸” ì¶”ê°€

```sql
llm_providers (
  id INTEGER PRIMARY KEY,
  userId TEXT NOT NULL,
  name TEXT NOT NULL,
  providerType TEXT NOT NULL,  -- "openai" | "anthropic" | "google" | "custom"
  apiKeyEncrypted TEXT NOT NULL,
  baseUrl TEXT,
  defaultModel TEXT,
  createdAt DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

### bot_settings ì»¬ëŸ¼ ì¶”ê°€

```sql
ALTER TABLE bot_settings ADD COLUMN llmProviderId INTEGER;
ALTER TABLE bot_settings ADD COLUMN modelOverride TEXT;
```

---

## Step 3-2. Storage í•¨ìˆ˜ ì¶”ê°€

ë‹¤ìŒ í•¨ìˆ˜ êµ¬í˜„:

* createLLMProvider(userId, data)
* listLLMProviders(userId)
* getLLMProvider(id, userId)
* updateLLMProvider(id, userId, data)
* deleteLLMProvider(id, userId)

ì¶”ê°€ ìœ í‹¸:

* getBotLLMConfig(botId, userId)
* resolveLLMForBot(botId) â†’ { providerType, apiKey, baseUrl, model }

---

## Step 3-3. API ë¼ìš°íŠ¸ ì¶”ê°€

```http
GET    /api/llm-providers
POST   /api/llm-providers
PUT    /api/llm-providers/:id
DELETE /api/llm-providers/:id
```

```http
PUT /api/bots/:id/settings/llm
Body: { llmProviderId, modelOverride }
```

ëª¨ë“  ìš”ì²­ì€ userId ì†Œìœ ê¶Œ ì²´í¬ í•„ìˆ˜.

---

## Step 3-4. LLM í˜¸ì¶œ ë ˆì´ì–´ ë¦¬íŒ©í„°ë§

ê¸°ì¡´:

* callLLMWithJsonParsing() ì´ íŠ¹ì • Provider ì¢…ì†

ë³€ê²½:

* Provider-agnostic êµ¬ì¡°ë¡œ ë¦¬íŒ©í„°ë§

ê³µí†µ ì¸í„°í˜ì´ìŠ¤:

```ts
callLLM({
  providerType,
  apiKey,
  baseUrl,
  model,
  prompt,
  responseFormat
})
```

Provider ì–´ëŒ‘í„° ë¶„ë¦¬:

* providers/openai.ts
* providers/anthropic.ts
* providers/google.ts
* providers/custom.ts

ê°ê°:

```ts
export async function generate(prompt, options): Promise<string>
```

---

## Step 3-5. ë¦¬í¬íŠ¸ / ë¶„ì„ íŒŒì´í”„ë¼ì¸ ìˆ˜ì •

ëª¨ë“  LLM í˜¸ì¶œ íë¦„ì„ ë‹¤ìŒì²˜ëŸ¼ ë³€ê²½:

1. botId ê¸°ì¤€ìœ¼ë¡œ bot_settings ì¡°íšŒ
2. llmProviderId ê°€ì ¸ì˜¤ê¸°
3. resolveLLMForBot(botId) í˜¸ì¶œ
4. í•´ë‹¹ provider adapterë¡œ LLM í˜¸ì¶œ
5. ê²°ê³¼ ì €ì¥

â—ï¸í•˜ë“œì½”ë”©ëœ ê¸°ë³¸ LLM í˜¸ì¶œ ì „ë¶€ ì œê±°

---

## Step 3-6. UI ì¶”ê°€

### Settings > LLM Providers í˜ì´ì§€

ê¸°ëŠ¥:

* Provider ì¶”ê°€

  * name
  * providerType
  * apiKey
  * baseUrl (optional)
  * defaultModel
* Provider ëª©ë¡ / ìˆ˜ì • / ì‚­ì œ

### Bot Settings í˜ì´ì§€ì— ì¶”ê°€

* â€œì´ ë´‡ì—ì„œ ì‚¬ìš©í•  LLM Providerâ€ ë“œë¡­ë‹¤ìš´
* â€œModel Overrideâ€ ì…ë ¥ í•„ë“œ

---

## Step 3-7. ë³´ì•ˆ ê·œì¹™

* API KeyëŠ” ë°˜ë“œì‹œ ì•”í˜¸í™” ì €ì¥
* ì„œë²„ì—ì„œë§Œ ë³µí˜¸í™”
* í´ë¼ì´ì–¸íŠ¸ë¡œ ì ˆëŒ€ ë°˜í™˜í•˜ì§€ ë§ ê²ƒ
* LLM ë¯¸ì„¤ì • ì‹œ:

  * ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€: â€œì´ ë´‡ì— LLM Providerê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤â€

---

## Step 3-8. ì™„ë£Œ ì¡°ê±´ (DoD)

* ì‚¬ìš©ìê°€ LLM Provider CRUD ê°€ëŠ¥
* ë´‡ë§ˆë‹¤ ë‹¤ë¥¸ LLM ì—°ê²° ê°€ëŠ¥
* ë¦¬í¬íŠ¸/ë¶„ì„/ì´ˆì•ˆ ìƒì„± ì‹œ í•´ë‹¹ ë´‡ì˜ LLM ì‚¬ìš©
* ê¸°ì¡´ ai_art / investing ë´‡ ì •ìƒ ë™ì‘
* ì‹œìŠ¤í…œ ê¸°ë³¸ LLM ì˜ì¡´ ì½”ë“œ ì œê±° ì™„ë£Œ

---

## ì´ë²ˆ Phaseì—ì„œ í•˜ì§€ ë§ ê²ƒ âŒ

* ë§íˆ¬ / ìºë¦­í„° / ìŠ¤íƒ€ì¼ í”„ë¦¬ì…‹
* í™ë³´ ì„±í–¥ / ì»¤ë®¤ë‹ˆí‹° ëª¨ë“œ
* ìë™ í¬ìŠ¤íŒ…
* ì •ì±… / ì•½ê´€ / ë²•ì  ê°€ë“œ UI

(ì´ê±´ Phase 4ì—ì„œ ì§„í–‰)

---

ì´ê±¸ **Replit Assistantì— ê·¸ëŒ€ë¡œ ë¶™ì—¬ë„£ê³  ì‹¤í–‰**í•˜ë©´ ë©ë‹ˆë‹¤.
ë‹¤ ëë‚˜ë©´ ë‹¤ìŒ ë‹¨ê³„ì—ì„œ **â€œë´‡ ì„±ê²©/ìŠ¤íƒ€ì¼/ìš´ì˜ ëª¨ë“œâ€ ë ˆì´ì–´** ì–¹ìœ¼ë©´, ì§„ì§œ í”Œë«í¼ ë©ë‹ˆë‹¤.
